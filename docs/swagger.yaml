openapi: 3.0.0
info:
  title: LGU Payment API
  description: API documentation for LGU Payment System Transaction Controller
  version: "1.0.0"

servers:
  - url: https://api.lgu-payment-uat.netglobalsolutions.net/

tags:
  - name: Transaction
    description: Endpoints for payment transactions

paths:
  /api-categories:
    get:
      tags:
        - Transaction
      summary: Get all categories
      description: Returns the list of available categories.
      security:
        - ApiKeyAuth: []
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              example:
                success: true
                data:
                  - cat_code: "BPLS"
                    cat_category: "Business Permit"
                  - cat_code: "RPT"
                    cat_category: "Real Property Tax"
        "401":
          description: Missing or invalid API Key
          content:
            application/json:
              example:
                success: false
                message: "Missing API Key"
                response: []

  /api-create-transactions:
    post:
      tags:
        - Transaction
      summary: Create a transaction
      description: Initiates a new payment transaction and generates a QR code.
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            example:
              reference_number: "REF-1234567890"
              name: "RON"
              amount: "100"
              mobile_number: "09771741876"
              email: "devs@netglobalsolutions.net"
              convience_fee: "25.000"
              company: "NGSI"
              services: ["BP0029", "10", "123.00", "100.00"]
      responses:
        "201":
          description: Transaction created successfully
          content:
            application/json:
              example:
                success: true
                status_code: 201
                response:
                  redirect_url: "https://lgu-payment-uat.netglobalsolutions.net/payment-form?ref=REF-1234567890"
                  raw_string: "00020101021228760011ph.ppmi.p2m0111OPDVPHM1XXX03157771480000000840416529481372565265105030015204601653036085406100.005802PH5909Netglobal6015City Of Mandalu62430010ph.allbank0525292025REF-250211449EHKXPM88310012ph.ppmi.qrph0111OPDVPHM1XXX63049FEC"
                  create_at: "2025-10-08 02:11:44"
                  reference_number: "REF-1234567890"
                  ref_id: "REF-250211449EHKXPMI7UOYH0XT"
        "400":
          description: Missing required fields or duplicate reference
          content:
            application/json:
              example:
                success: false
                status_code: 400
                response:
                  message: "Transaction already exists"
                  response: []
        "401":
          description: Missing or invalid API Key 
          content:
            application/json:
              example:
                success: false
                message: "Missing API Key"
                response: []          
        "502":
          description: Failed to generate transaction from API
          content:
            application/json:
              example:
                success: false
                status_code: 502
                response:
                  message: "Failed to generate transaction from API"
                  response: []

  /api-checkref:
    get:
      tags:
        - Transaction
      summary: Check transaction by reference ID
      description: Retrieves details of a transaction by `ref_id`.
      parameters:
        - in: query
          name: ref_id
          required: true
          schema:
            type: string
          example: REF123456
      responses:
        "200":
          description: Transaction details found
          content:
            application/json:
              example:
                success: true
                ref_id: REF123456
                name: Juan Dela Cruz
                company: LGU Manila
                mobile: "639171234567"
                email: juan.delacruz@example.com
                sub_total: 1500
                conv_fee: 50
                grand_total: 1550
                department: BPLS
                status: CREATED
                qr_url: "https://sample-qr.png"
                items:
                  - code: SVC001
                    description: Business Permit Fee
                    qty: 1
                    amount: 1500
                    other_fees: 0
                    total: 1500
        "404":
          description: Transaction not found
          content:
            application/json:
              example:
                success: false
                message: "Transaction not found"
                response: []
        "400":
          description: Missing ref_id
          content:
            application/json:
              example:
                success: false
                message: "Missing ref_id"
                response: []

  /api-checkstatus:
    get:
      tags:
        - Transaction
      summary: Get transaction status
      description: Retrieves the current status of a transaction.
      parameters:
        - in: query
          name: ref_id
          required: true
          schema:
            type: string
          example: REF123456
      responses:
        "200":
          description: Transaction status retrieved
          content:
            application/json:
              example:
                success: true
                status_code: 200
                data:
                  status: "PAID"
                  reference_number: "REF-1234567890"
                  ref_id: "REF-250211449EHKXPMI7UOYH0XT"
                  fee: "25.000"
                  amount: "100.000"
                  total_amount: "125.000"
                  settled_date: "2025-10-08 02:12:24"
                  payment-reference: ""
                  transaction_id: ""
        "404":
          description: Transaction not found
          content:
            application/json:
              example:
                success: false
                message: "Transaction not found"
                response: []
        "400":
          description: Missing ref_id
          content:
            application/json:
              example:
                success: false
                message: "Missing ref_id"
                response: []

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-KEY
